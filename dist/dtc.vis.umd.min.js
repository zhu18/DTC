/**
  * dtc V1.0.3
  * (c) 2018-2019
  * Copyright all contributors
  * @license Released under MIT license.
  */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("three")):"function"==typeof define&&define.amd?define(["exports","three"],t):t((e=e||self).dtc={},e.THREE)}(this,function(e,t){"use strict";function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function a(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&u(e,t)}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e,t,n){return(c=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct:function(e,t,n){var o=[null];o.push.apply(o,t);var i=new(Function.bind.apply(e,o));return n&&u(i,n.prototype),i}).apply(null,arguments)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?l(e):t}function d(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var m={canvas:!!window.CanvasRenderingContext2D,webgl:function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}(),workers:!!window.Worker,fileapi:window.File&&window.FileReader&&window.FileList&&window.Blob,getWebGLErrorMessage:function(){var e=document.createElement("div");return e.id="webgl-error-message",e.style.fontFamily="monospace",e.style.fontSize="13px",e.style.fontWeight="normal",e.style.textAlign="center",e.style.background="#fff",e.style.color="#000",e.style.padding="1.5em",e.style.width="400px",e.style.margin="5em auto 0",this.webgl||(e.innerHTML=window.WebGLRenderingContext?['Your graphics card does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br />','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n"):['Your browser does not seem to support <a href="http://khronos.org/webgl/wiki/Getting_a_WebGL_Implementation" style="color:#000">WebGL</a>.<br/>','Find out how to get it <a href="http://get.webgl.org/" style="color:#000">here</a>.'].join("\n")),e},addGetWebGLMessage:function(e){var t,n,o;t=void 0!==(e=e||{}).parent?e.parent:document.body,n=void 0!==e.id?e.id:"oldie",(o=m.getWebGLErrorMessage()).id=n,t.appendChild(o)}};function p(e,n){var o,i,a,r,s;this.object=e,this.domElement=void 0!==n?n:document,this.enabled=!0,this.target=new t.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:t.MOUSE.LEFT,ZOOM:t.MOUSE.MIDDLE,PAN:t.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.saveState=function(){u.target0.copy(u.target),u.position0.copy(u.object.position),u.zoom0=u.object.zoom},this.reset=function(){u.target.copy(u.target0),u.object.position.copy(u.position0),u.object.zoom=u.zoom0,u.object.updateProjectionMatrix(),u.dispatchEvent(c),u.update(),m=d.NONE},this.update=(o=new t.Vector3,i=(new t.Quaternion).setFromUnitVectors(e.up,new t.Vector3(0,1,0)),a=i.clone().inverse(),r=new t.Vector3,s=new t.Quaternion,function(){var e=u.object.position;return o.copy(e).sub(u.target),o.applyQuaternion(i),f.setFromVector3(o),u.autoRotate&&m===d.NONE&&P(2*Math.PI/60/60*u.autoRotateSpeed),f.theta+=v.theta,f.phi+=v.phi,f.theta=Math.max(u.minAzimuthAngle,Math.min(u.maxAzimuthAngle,f.theta)),f.phi=Math.max(u.minPolarAngle,Math.min(u.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=g,f.radius=Math.max(u.minDistance,Math.min(u.maxDistance,f.radius)),u.target.add(y),o.setFromSpherical(f),o.applyQuaternion(a),e.copy(u.target).add(o),u.object.lookAt(u.target),!0===u.enableDamping?(v.theta*=1-u.dampingFactor,v.phi*=1-u.dampingFactor):v.set(0,0,0),g=1,y.set(0,0,0),!!(b||r.distanceToSquared(u.object.position)>p||8*(1-s.dot(u.object.quaternion))>p)&&(u.dispatchEvent(c),r.copy(u.object.position),s.copy(u.object.quaternion),b=!1,!0)}),this.dispose=function(){u.domElement.removeEventListener("contextmenu",Y,!1),u.domElement.removeEventListener("mousedown",G,!1),u.domElement.removeEventListener("wheel",F,!1),u.domElement.removeEventListener("touchstart",U,!1),u.domElement.removeEventListener("touchend",W,!1),u.domElement.removeEventListener("touchmove",B,!1),document.removeEventListener("mousemove",I,!1),document.removeEventListener("mouseup",N,!1),window.removeEventListener("keydown",V,!1)};var u=this,c={type:"change"},l={type:"start"},h={type:"end"},d={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},m=d.NONE,p=1e-6,f=new t.Spherical,v=new t.Spherical,g=1,y=new t.Vector3,b=!1,w=new t.Vector2,E=new t.Vector2,x=new t.Vector2,_=new t.Vector2,M=new t.Vector2,O=new t.Vector2,D=new t.Vector2,j=new t.Vector2,C=new t.Vector2;function k(){return Math.pow(.95,u.zoomSpeed)}function P(e){v.theta-=e}function T(e){v.phi-=e}var R,A=(R=new t.Vector3,function(e,t){R.setFromMatrixColumn(t,0),R.multiplyScalar(-e),y.add(R)}),S=function(){var e=new t.Vector3;return function(t,n){e.setFromMatrixColumn(n,1),e.multiplyScalar(t),y.add(e)}}(),L=function(){var e=new t.Vector3;return function(t,n){var o=u.domElement===document?u.domElement.body:u.domElement;if(u.object.isPerspectiveCamera){var i=u.object.position;e.copy(i).sub(u.target);var a=e.length();a*=Math.tan(u.object.fov/2*Math.PI/180),A(2*t*a/o.clientHeight,u.object.matrix),S(2*n*a/o.clientHeight,u.object.matrix)}else u.object.isOrthographicCamera?(A(t*(u.object.right-u.object.left)/u.object.zoom/o.clientWidth,u.object.matrix),S(n*(u.object.top-u.object.bottom)/u.object.zoom/o.clientHeight,u.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),u.enablePan=!1)}}();function z(e){u.object.isPerspectiveCamera?g/=e:u.object.isOrthographicCamera?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom*e)),u.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),u.enableZoom=!1)}function H(e){u.object.isPerspectiveCamera?g*=e:u.object.isOrthographicCamera?(u.object.zoom=Math.max(u.minZoom,Math.min(u.maxZoom,u.object.zoom/e)),u.object.updateProjectionMatrix(),b=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),u.enableZoom=!1)}function G(e){if(!1!==u.enabled){switch(e.preventDefault(),e.button){case u.mouseButtons.ORBIT:if(!1===u.enableRotate)return;!function(e){w.set(e.clientX,e.clientY)}(e),m=d.ROTATE;break;case u.mouseButtons.ZOOM:if(!1===u.enableZoom)return;!function(e){D.set(e.clientX,e.clientY)}(e),m=d.DOLLY;break;case u.mouseButtons.PAN:if(!1===u.enablePan)return;!function(e){_.set(e.clientX,e.clientY)}(e),m=d.PAN}m!==d.NONE&&(document.addEventListener("mousemove",I,!1),document.addEventListener("mouseup",N,!1),u.dispatchEvent(l))}}function I(e){if(!1!==u.enabled)switch(e.preventDefault(),m){case d.ROTATE:if(!1===u.enableRotate)return;!function(e){E.set(e.clientX,e.clientY),x.subVectors(E,w);var t=u.domElement===document?u.domElement.body:u.domElement;P(2*Math.PI*x.x/t.clientWidth*u.rotateSpeed),T(2*Math.PI*x.y/t.clientHeight*u.rotateSpeed),w.copy(E),u.update()}(e);break;case d.DOLLY:if(!1===u.enableZoom)return;!function(e){j.set(e.clientX,e.clientY),C.subVectors(j,D),C.y>0?z(k()):C.y<0&&H(k()),D.copy(j),u.update()}(e);break;case d.PAN:if(!1===u.enablePan)return;!function(e){M.set(e.clientX,e.clientY),O.subVectors(M,_),L(O.x,O.y),_.copy(M),u.update()}(e)}}function N(e){!1!==u.enabled&&(document.removeEventListener("mousemove",I,!1),document.removeEventListener("mouseup",N,!1),u.dispatchEvent(h),m=d.NONE)}function F(e){!1===u.enabled||!1===u.enableZoom||m!==d.NONE&&m!==d.ROTATE||(e.preventDefault(),e.stopPropagation(),function(e){e.deltaY<0?H(k()):e.deltaY>0&&z(k()),u.update()}(e),u.dispatchEvent(l),u.dispatchEvent(h))}function V(e){!1!==u.enabled&&!1!==u.enableKeys&&!1!==u.enablePan&&function(e){switch(e.keyCode){case u.keys.UP:L(0,u.keyPanSpeed),u.update();break;case u.keys.BOTTOM:L(0,-u.keyPanSpeed),u.update();break;case u.keys.LEFT:L(u.keyPanSpeed,0),u.update();break;case u.keys.RIGHT:L(-u.keyPanSpeed,0),u.update()}}(e)}function U(e){if(!1!==u.enabled){switch(e.touches.length){case 1:if(!1===u.enableRotate)return;!function(e){w.set(e.touches[0].pageX,e.touches[0].pageY)}(e),m=d.TOUCH_ROTATE;break;case 2:if(!1===u.enableZoom)return;!function(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);D.set(0,o)}(e),m=d.TOUCH_DOLLY;break;case 3:if(!1===u.enablePan)return;!function(e){_.set(e.touches[0].pageX,e.touches[0].pageY)}(e),m=d.TOUCH_PAN;break;default:m=d.NONE}m!==d.NONE&&u.dispatchEvent(l)}}function B(e){if(!1!==u.enabled)switch(e.preventDefault(),e.stopPropagation(),e.touches.length){case 1:if(!1===u.enableRotate)return;if(m!==d.TOUCH_ROTATE)return;!function(e){E.set(e.touches[0].pageX,e.touches[0].pageY),x.subVectors(E,w);var t=u.domElement===document?u.domElement.body:u.domElement;P(2*Math.PI*x.x/t.clientWidth*u.rotateSpeed),T(2*Math.PI*x.y/t.clientHeight*u.rotateSpeed),w.copy(E),u.update()}(e);break;case 2:if(!1===u.enableZoom)return;if(m!==d.TOUCH_DOLLY)return;!function(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,o=Math.sqrt(t*t+n*n);j.set(0,o),C.subVectors(j,D),C.y>0?H(k()):C.y<0&&z(k()),D.copy(j),u.update()}(e);break;case 3:if(!1===u.enablePan)return;if(m!==d.TOUCH_PAN)return;!function(e){M.set(e.touches[0].pageX,e.touches[0].pageY),O.subVectors(M,_),L(O.x,O.y),_.copy(M),u.update()}(e);break;default:m=d.NONE}}function W(e){!1!==u.enabled&&(u.dispatchEvent(h),m=d.NONE)}function Y(e){!1!==u.enabled&&e.preventDefault()}u.domElement.addEventListener("contextmenu",Y,!1),u.domElement.addEventListener("mousedown",G,!1),u.domElement.addEventListener("wheel",F,!1),u.domElement.addEventListener("touchstart",U,!1),u.domElement.addEventListener("touchend",W,!1),u.domElement.addEventListener("touchmove",B,!1),window.addEventListener("keydown",V,!1),this.update()}p.prototype=Object.create(t.EventDispatcher.prototype),p.prototype.constructor=p,Object.defineProperties(p.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(e){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!e}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(e){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!e}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(e){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!e}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(e){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!e}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(e){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!e}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(e){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=e}}});var f=function(){function e(n){o(this,e),this.__raycaster=new t.Raycaster,this.__mouse=new t.Vector2,this.__resize=n.__proto__._onResize,this.__mousemove=n.__proto__._onMouseMove,this.__mousedown=n.__proto__._onMouseDown,this.target=n,Object.assign(this,n),this.camera||this.renderer||this.el?this.__resize||this.__mousemove||this.__mousedown?(this.__resize__=this.onWindowResize.bind(this),this.__mousemove__=this.onDocumentMouseMove.bind(this),this.__touchstart__=this.onDocumentTouchStart.bind(this),this.__mousedown__=this.onDocumentMouseDown.bind(this),this.mousemove_timer=null,this.mousemove_interval=10,this.enable=!0,this.__resize&&window.addEventListener("resize",this.__resize__,!1),this.__mousemove&&this.el.addEventListener("mousemove",this.__mousemove__,!1),this.__mousedown&&(this.el.addEventListener("touchstart",this.__touchstart__,!1),this.el.addEventListener("mousedown",this.__mousedown__,!1))):console.warn("THREE.Event:Users need to implement _onResize(),_onMouseMove(),_onMouseDown() method"):console.warn("THREE.Event:not find camera, renderer, domElement,Please ensure that it is a valid 3D control")}return a(e,[{key:"dispose",value:function(){window.removeEventListener("resize",this.__resize__,!1),this.el.removeEventListener("mousemove",this.__mousemove__,!1),this.el.removeEventListener("touchstart",this.__touchstart__,!1),this.el.removeEventListener("mousedown",this.__mousedown__,!1)}},{key:"onWindowResize",value:function(e){this.camera.aspect=this.el.offsetWidth/this.el.offsetHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.el.offsetWidth,this.el.offsetHeight),this.enable&&this.__resize.bind(this.target)(e)}},{key:"onDocumentMouseMove",value:function(e){var t=this;e.preventDefault(),this.mousemove_timer&&clearTimeout(this.mousemove_timer),this.mousemove_timer=setTimeout(function(){t.__mouse.x=e.offsetX/t.el.offsetWidth*2-1,t.__mouse.y=-e.offsetY/t.el.offsetHeight*2+1,t.__raycaster.setFromCamera(t.__mouse,t.camera);var n=t.__raycaster.intersectObjects(t.scene.children,!0);t.enable&&t.__mousemove.bind(t.target)(e,n)},this.mousemove_interval)}},{key:"onDocumentTouchStart",value:function(e){e.preventDefault(),e.clientX=e.touches[0].pageX,e.clientY=e.touches[0].pageY,this.enable&&this.onDocumentMouseDown(e)}},{key:"onDocumentMouseDown",value:function(e){e.preventDefault(),this.__mouse.x=(e.offsetX||e.clientX)/this.el.offsetWidth*2-1,this.__mouse.y=-(e.offsetY||e.clientY)/this.el.offsetHeight*2+1,this.__raycaster.setFromCamera(this.__mouse,this.camera);var t=this.__raycaster.intersectObjects(this.scene.children,!0);this.enable&&this.__mousedown.bind(this.target)(e,t)}}]),e}();void 0===Date.now&&(Date.now=function(){return(new Date).valueOf()});var v,g=g||(v=[],{REVISION:"14",getAll:function(){return v},removeAll:function(){v=[]},add:function(e){v.push(e)},remove:function(e){var t=v.indexOf(e);-1!==t&&v.splice(t,1)},update:function(e){if(0===v.length)return!1;var t=0;for(e=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now();t<v.length;)v[t].update(e)?t++:v.splice(t,1);return!0}});function y(e){return"string"==typeof e&&(e=-1!==e.indexOf("#")?parseInt(e.replace("#",""),16):new t.Color(e).getHex()),e}function b(e,t,n,o,i,a){"number"!=typeof n&&(n=1e3),a||(a=function(){}),new g.Tween(e).to(t,n).delay(o||0).easing(i||g.Easing.Linear.None).start().onComplete(a)}g.Tween=function(e){var t=e,n={},o={},i={},a=1e3,r=0,s=!1,u=!1,c=0,l=null,h=g.Easing.Linear.None,d=g.Interpolation.Linear,m=[],p=null,f=!1,v=null,y=null,b=null;for(var w in e)n[w]=parseFloat(e[w],10);this.to=function(e,t){return void 0!==t&&(a=t),o=e,this},this.start=function(e){for(var a in g.add(this),u=!0,f=!1,l=void 0!==e?e:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?window.performance.now():Date.now(),l+=c,o){if(o[a]instanceof Array){if(0===o[a].length)continue;o[a]=[t[a]].concat(o[a])}n[a]=t[a],n[a]instanceof Array==0&&(n[a]*=1),i[a]=n[a]||0}return this},this.stop=function(){return u?(g.remove(this),u=!1,null!==b&&b.call(t),this.stopChainedTweens(),this):this},this.stopChainedTweens=function(){for(var e=0,t=m.length;t>e;e++)m[e].stop()},this.delay=function(e){return c=e,this},this.repeat=function(e){return r=e,this},this.yoyo=function(e){return s=e,this},this.easing=function(e){return h=e,this},this.interpolation=function(e){return d=e,this},this.chain=function(){return m=arguments,this},this.onStart=function(e){return p=e,this},this.onUpdate=function(e){return v=e,this},this.onComplete=function(e){return y=e,this},this.onStop=function(e){return b=e,this},this.update=function(e){var u;if(l>e)return!0;!1===f&&(null!==p&&p.call(t),f=!0);var g=(e-l)/a,b=h(g=g>1?1:g);for(u in o){var w=n[u]||0,E=o[u];E instanceof Array?t[u]=d(E,b):("string"==typeof E&&(E=w+parseFloat(E,10)),"number"==typeof E&&(t[u]=w+(E-w)*b))}if(null!==v&&v.call(t,b),1==g){if(r>0){for(u in isFinite(r)&&r--,i){if("string"==typeof o[u]&&(i[u]=i[u]+parseFloat(o[u],10)),s){var x=i[u];i[u]=o[u],o[u]=x}n[u]=i[u]}return l=e+c,!0}null!==y&&y.call(t);for(var _=0,M=m.length;M>_;_++)m[_].start(e);return!1}return!0}},g.Easing={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),-n*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/.4))},Out:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*e)*Math.sin(2*(e-t)*Math.PI/.4)+1)},InOut:function(e){var t,n=.1;return 0===e?0:1===e?1:(!n||1>n?(n=1,t=.1):t=.4*Math.asin(1/n)/(2*Math.PI),(e*=2)<1?-.5*n*Math.pow(2,10*(e-=1))*Math.sin(2*(e-t)*Math.PI/.4):n*Math.pow(2,-10*(e-=1))*Math.sin(2*(e-t)*Math.PI/.4)*.5+1)}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?.5*e*e*((t+1)*e-t):.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-g.Easing.Bounce.Out(1-e)},Out:function(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return.5>e?.5*g.Easing.Bounce.In(2*e):.5*g.Easing.Bounce.Out(2*e-1)+.5}}},g.Interpolation={Linear:function(e,t){var n=e.length-1,o=n*t,i=Math.floor(o),a=g.Interpolation.Utils.Linear;return 0>t?a(e[0],e[1],o):t>1?a(e[n],e[n-1],n-o):a(e[i],e[i+1>n?n:i+1],o-i)},Bezier:function(e,t){var n,o=0,i=e.length-1,a=Math.pow,r=g.Interpolation.Utils.Bernstein;for(n=0;i>=n;n++)o+=a(1-t,i-n)*a(t,n)*e[n]*r(i,n);return o},CatmullRom:function(e,t){var n=e.length-1,o=n*t,i=Math.floor(o),a=g.Interpolation.Utils.CatmullRom;return e[0]===e[n]?(0>t&&(i=Math.floor(o=n*(1+t))),a(e[(i-1+n)%n],e[i],e[(i+1)%n],e[(i+2)%n],o-i)):0>t?e[0]-(a(e[0],e[0],e[1],e[1],-o)-e[0]):t>1?e[n]-(a(e[n],e[n],e[n-1],e[n-1],o-n)-e[n]):a(e[i?i-1:0],e[i],e[i+1>n?n:i+1],e[i+2>n?n:i+2],o-i)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=g.Interpolation.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n,o=1;if(e[t])return e[t];for(n=t;n>1;n--)o*=n;return e[t]=o}}(),CatmullRom:function(e,t,n,o,i){var a=.5*(n-e),r=.5*(o-t),s=i*i;return(2*t-2*n+a+r)*(i*s)+(-3*t+3*n-2*a-r)*s+a*i+t}}};var w,E,x,_,M,O,D,j=(E=Object.prototype.toString,x=Object.prototype.hasOwnProperty,_={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Object]":"object"},M=function(e){return null==e?String(e):_[E.call(e)]||"object"},O=Array.isArray||function(e){return"array"===M(e)},D=function(e){if(!e||"object"!==M(e)||e.nodeType||function(e){return e&&"object"===n(e)&&"setInterval"in e}(e))return!1;if(e.constructor&&!x.call(e,"constructor")&&!x.call(e.constructor.prototype,"isPrototypeOf"))return!1;var t;for(t in e);return void 0===t||x.call(e,t)},function e(t,n,o){for(var i in o){var a=n[i],r=o[i];if(n!==r)if(t&&r&&(D(r)||(w=O(r)))){if(w){w=!1;var s=a&&O(a)?a:[]}else s=a&&D(a)?a:{};n[i]=e(t,s,r)}else void 0!==r&&(n[i]=r)}return n}),C=function(){function e(){o(this,e)}return a(e,null,[{key:"create",value:function(e,n){var o={size:50,follow:!0,family:"Arial",borderColor:"#000000",color:"#ffffff",style:"oblique",weight:"bold"};return Object.assign(o,n),function(e,n){var o=document.createElement("canvas"),i=o.getContext("2d");o.width=512,o.height=512,i.clearRect(0,0,512,512),i.font="100px "+n.family,i.fillStyle=n.color,i.textAlign="center",i.fillText(e,256,256),i.strokeStyle=n.borderColor,i.strokeText(e,256,256);var a=new t.Texture(o);a.needsUpdate=!0;var r=null;if(n.follow){var s=new t.SpriteMaterial({map:a});r=new t.Sprite(s)}else{var u=new t.MeshBasicMaterial({map:a,color:16777215,transparent:!0,side:t.DoubleSide}),c=new t.PlaneGeometry(1,1,1,1);r=new t.Mesh(c,u)}return r.scale.set(n.size/10,n.size/10,1),r}(e,o)}}]),e}();var k,P=(function(e){e.exports&&(e.exports=function(){var e=Date.now(),t=e,n=0,o=1/0,i=0,a=0,r=1/0,s=0,u=0,c=0,l=document.createElement("div");l.id="stats",l.addEventListener("mousedown",function(e){e.preventDefault(),y(++c%2)},!1),l.style.cssText="width:80px;opacity:0.9;cursor:pointer";var h=document.createElement("div");h.id="fps",h.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#002",l.appendChild(h);var d=document.createElement("div");d.id="fpsText",d.style.cssText="color:#0ff;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",d.innerHTML="FPS",h.appendChild(d);var m=document.createElement("div");for(m.id="fpsGraph",m.style.cssText="position:relative;width:74px;height:30px;background-color:#0ff",h.appendChild(m);m.children.length<74;)(g=document.createElement("span")).style.cssText="width:1px;height:30px;float:left;background-color:#113",m.appendChild(g);var p=document.createElement("div");p.id="ms",p.style.cssText="padding:0 0 3px 3px;text-align:left;background-color:#020;display:none",l.appendChild(p);var f=document.createElement("div");f.id="msText",f.style.cssText="color:#0f0;font-family:Helvetica,Arial,sans-serif;font-size:9px;font-weight:bold;line-height:15px",f.innerHTML="MS",p.appendChild(f);var v=document.createElement("div");for(v.id="msGraph",v.style.cssText="position:relative;width:74px;height:30px;background-color:#0f0",p.appendChild(v);v.children.length<74;){var g;(g=document.createElement("span")).style.cssText="width:1px;height:30px;float:left;background-color:#131",v.appendChild(g)}var y=function(e){switch(c=e){case 0:h.style.display="block",p.style.display="none";break;case 1:h.style.display="none",p.style.display="block"}},b=function(e,t){e.appendChild(e.firstChild).style.height=t+"px"};return{REVISION:11,domElement:l,setMode:y,begin:function(){e=Date.now()},end:function(){var c=Date.now();return n=c-e,o=Math.min(o,n),i=Math.max(i,n),f.textContent=n+" MS ("+o+"-"+i+")",b(v,Math.min(30,30-n/200*30)),u++,c>t+1e3&&(a=Math.round(1e3*u/(c-t)),r=Math.min(r,a),s=Math.max(s,a),d.textContent=a+" FPS ("+r+"-"+s+")",b(m,Math.min(30,30-a/100*30)),t=c,u=0),c},update:function(){e=this.end()}}})}(k={exports:{}},k.exports),k.exports),T=function(e){function n(e){var t;o(this,n),(t=h(this,s(n).call(this,e))).type="Area",t.name=e.name,Object.assign(t.userData,e);var i=e.coords;return t._mesh=t.getMesh(i,e),t._line=t.getLine(i,e),t.add(t._mesh),t.add(t._line),e.loadEffect&&(t.setPosition({x:0,y:-40,z:-1e3}),t.setPosition({x:0,y:0,z:0},500,10*n.count,g.Easing.Quartic.Out)),n.count++,t}return r(n,t.Object3D),a(n,[{key:"getMesh",value:function(e,n){var o=this;if(e)try{var i=new t.Geometry;return e.forEach(function(e){var t=o.getGeoPoints(e),n=o.getExtrudeGeometry(t);i.merge(n,n.matrix)}),this.getGeoMesh(i,n)}catch(e){console.warn("Area.getMesh:"+e.message)}}},{key:"getLine",value:function(e,n){var o=this;if(e){var i=new t.LineBasicMaterial({opacity:1,linewidth:2,polygonOffset:!0,polygonOffsetFactor:1,color:this.userData.lineColor}),a=new t.Group;return e.forEach(function(e){for(var n=o.getGeoPoints(e),r=new t.Geometry,s=0,u=n.length;s<u;s++)r.vertices.push(new t.Vector3(n[s].x,n[s].y,o.userData.extrude.amount+o.userData.extrude.amount/100));var c=new t.Line(r,i);a.add(c)}),a}}},{key:"getGeoPoints",value:function(e){try{for(var n=[],o=0,i=e.length;o<i;o++)n.push(new t.Vector2(e[o][0],e[o][1]));return n}catch(t){console.log("getGeoPoints:parse coord error:"+JSON.stringify(e))}}},{key:"getExtrudeGeometry",value:function(e){var n=new t.Shape(e),o=Object.assign({},this.userData.extrude);return new t.ExtrudeGeometry(n,o)}},{key:"getGeoMesh",value:function(e,n){var o={};o.color=null!=n.color?y(n.color):16777215*Math.random(),o.shininess=n.shininess||100,o.transparent=!0,o.opacity=void 0===n.opacity?this.userData.opacity:n.opacity,e.computeFlatVertexNormals();return this.update=function(){},this.userData.hasPhong?new t.Mesh(e,new t.MeshPhongMaterial(o)):new t.Mesh(e,new t.MeshLambertMaterial(o))}},{key:"setColor",value:function(e,n,o,i,a){this.userData.color=y(e),n&&"number"==typeof n?(e=new t.Color(y(e)),b(this.mesh.material.color,e,n,o,i,a)):this.mesh.material.color.set(y(e))}},{key:"setPosition",value:function(e,t,n,o,i){t&&"number"==typeof t?b(this.position,e,t,n,o,i):this.position.set(e.x,e.y,e.z)}},{key:"setRotation",value:function(e,t,n,o,i){e.x=e.x*(Math.PI/180),e.y=e.y*(Math.PI/180),e.z=e.z*(Math.PI/180),b(this.rotation,e,t,n,o,i)}},{key:"setScale",value:function(e,t,n,o){t&&"number"==typeof t?b(this.scale,e,t,n,easing,callback):this.scale.set(e.x,e.y,e.z)}},{key:"onmouseout",value:function(e,n){this.userData.hasHoverHeight&&new g.Tween(this.position).to({z:0},this.userData.hoverAnimaTime).start(),new g.Tween(this.mesh.material.color).to(new t.Color(y(this.userData.color)),this.userData.hoverAnimaTime).start(),e.dispatchEvent({type:"mouseout",target:this,orgEvent:n})}},{key:"onmouseover",value:function(e,n){this.userData.hasHoverHeight&&new g.Tween(this.position).to({z:this.userData.extrude.amount/2},this.userData.hoverAnimaTime).start(),new g.Tween(this.mesh.material.color).to(new t.Color(y(this.userData.hoverColor)),this.userData.hoverAnimaTime).start(),e.dispatchEvent({type:"mouseover",target:this,orgEvent:n})}},{key:"onmousedown",value:function(e,t){e.dispatchEvent({type:"mousedown",target:this,orgEvent:t})}},{key:"mesh",get:function(){return this._mesh}},{key:"line",get:function(){return this._line}}]),n}();T.count=0;var R=function(e){function n(e){var i;o(this,n),(i=h(this,s(n).call(this,e))).type="DataRange",i.name=e.name,Object.assign(i.userData,e);var a=new t.BoxGeometry(e.width,e.height,e.extrudeHeight),r=new t.MeshPhongMaterial({color:e.color}),u=new t.Mesh(a,r);if(i.position.y=i.position.y-n.count*(e.height+e.spacing),e.showName){var c=Font3D.create(e.name,{color:"#ffffff"});c.position.copy(u.position),c.position.y=c.position.y-.3,c.position.add(e.namePosition),i.add(c),i.txt=c}return i.mesh=u,i.add(u),n.count++,i}return r(n,t.Object3D),a(n,[{key:"select",value:function(){var e=this;return this.rangeAreas.map(function(t){t.setColor(e.userData.hoverColor),t.userData.hasHoverHeight&&new g.Tween(t.position).to({z:t.userData.extrude.amount/2},t.userData.hoverAnimaTime).start()})}},{key:"unselect",value:function(){var e=this;this.rangeAreas.map(function(t){t.setColor(e.userData.color),t.userData.hasHoverHeight&&new g.Tween(t.position).to({z:0},t.userData.hoverAnimaTime).start()})}},{key:"onmouseout",value:function(e,n){this.unselect(),new g.Tween(this.mesh.material.color).to(new t.Color(y(this.userData.color)),this.userData.hoverAnimaTime).start(),this.userData.hasEvent&&e.dispatchEvent({type:"mouseout",target:this,orgEvent:n})}},{key:"onmouseover",value:function(e,n){this.select(),new g.Tween(this.mesh.material.color).to(new t.Color(y(this.userData.hoverColor)),this.userData.hoverAnimaTime).start(),this.userData.hasEvent&&e.dispatchEvent({type:"mouseover",target:this,orgEvent:n})}},{key:"onmousedown",value:function(e,t){this.userData.hasEvent&&e.dispatchEvent({type:"mousedown",target:this,orgEvent:t})}}]),n}();R.count=0;var A=function(e){function n(e){var i;o(this,n),(i=h(this,s(n).call(this))).material=new t.SpriteMaterial({map:n.texture,color:e.color,blending:t.AdditiveBlending}),i.type="Mark",i.name=e.name,Object.assign(i.userData,e);var a=e.size||i.userData.min;return a=(a=a<i.userData.min?i.userData.min:a)>i.userData.max?i.userData.max:a,i.userData.size=a,i.scale.set(a,a,1),i.position.x=e.coord[0],i.position.y=e.coord[1],i.position.z=2+35*a/100,i.update=function(){},n.count++,i}return r(n,t.Sprite),a(n,null,[{key:"draw",value:function(e,t){t=t||1,e.clearRect(0,0,128,128),e.fillStyle="#ffffff",e.arc(64,64,20,0,2*Math.PI,!1),e.fill(),e.fillStyle="rgba(255,255,255,.5)",e.arc(64,64,60*t,0,2*Math.PI,!1),e.fill()}},{key:"texture",get:function(){if(!n._texture){var e=document.createElement("canvas");e.width=128,e.height=128;var o=e.getContext("2d");n.draw(o);var i=new t.Texture(e);i.needsUpdate=!0,n._texture=i}return n._texture}}]),a(n,[{key:"setColor",value:function(e,n,o,i,a){this.userData.color=y(e),n&&"number"==typeof n?(e=new t.Color(y(e)),b(this.material.color,e,n,o,i,a)):this.material.color.set(y(e))}},{key:"setPosition",value:function(e,t,n,o,i){t&&"number"==typeof t?b(this.position,e,t,n,o,i):this.position.set(e.x,e.y,e.z)}},{key:"setRotation",value:function(e,t,n,o,i){e.x=e.x*(Math.PI/180),e.y=e.y*(Math.PI/180),e.z=e.z*(Math.PI/180),b(this.rotation,e,t,n,o,i)}},{key:"setScale",value:function(e,t,n,o,i){t&&"number"==typeof t?b(this.scale,e,t,n,o,i):this.scale.set(e.x,e.y,e.z)}},{key:"onmouseout",value:function(e,n){var o=1*this.userData.size;new g.Tween(this.scale).to({x:o,y:o},this.userData.hoverAnimaTime).start(),new g.Tween(this.material.color).to(new t.Color(y(this.userData.color)),this.userData.hoverAnimaTime).start(),e.dispatchEvent({type:"mouseout",target:this,orgEvent:n})}},{key:"onmouseover",value:function(e,n){var o=1.5*this.userData.size;new g.Tween(this.scale).to({x:o,y:o},this.userData.hoverAnimaTime).start(),new g.Tween(this.material.color).to(new t.Color(y(this.userData.hoverColor)),this.userData.hoverAnimaTime).start(),e.dispatchEvent({type:"mouseover",target:this,orgEvent:n})}},{key:"onmousedown",value:function(e,t){e.dispatchEvent({type:"mousedown",target:this,orgEvent:t})}}]),n}();A.count=0,A._texture=null;var S={};S.line={uniforms:{amplitude:{value:1},color:{value:16777215},texture:{value:null}},vertexShader:["uniform float amplitude;","attribute float size;","attribute vec3 customColor;","varying vec3 vColor;","void main() {","vColor = customColor;","vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );","gl_PointSize = size;","gl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform sampler2D texture;","varying vec3 vColor;","void main() {","gl_FragColor = vec4( color * vColor, 1.0 );","gl_FragColor = gl_FragColor * texture2D( texture, gl_PointCoord );","}"].join("\n")},S.edgelight={uniforms:{s:{type:"f",value:-1},b:{type:"f",value:1},p:{type:"f",value:2},glowColor:{type:"c",value:new t.Color(65535)}},vertexShader:["varying vec3 vNormal;","varying vec3 vPositionNormal;","void main() {","vNormal = normalize( normalMatrix * normal ); ","vPositionNormal = normalize(( modelViewMatrix * vec4(position, 1.0) ).xyz);","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform vec3 glowColor;","uniform float p;","uniform float b;","uniform float s;","varying vec3 vNormal;","varying vec3 vPositionNormal;","void main() ","{","  float a = pow( b + s * abs(dot(vNormal, vPositionNormal)), p );","  gl_FragColor = vec4( glowColor, a );","}"].join("\n")},S.createShaderMaterial=function(e,n,o){return new t.ShaderMaterial({uniforms:e.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader,side:n||t.FrontSide,blending:o||t.AdditiveBlending,transparent:!0})};var L=function(e){function n(e){var i;o(this,n);var a=e.coords[0],r=e.coords[1],u=a[0],d=a[1],m=r[0],p=r[1],f=m-u,v=p-d,g=Math.pow(f*f+v*v,.5),y=[new t.Vector3(u,d,e.extrudeHeight),new t.Vector3((u+m)/2,(d+p)/2,e.extrudeHeight+e.spaceHeight),new t.Vector3(m,p,e.extrudeHeight)],b=c(t.QuadraticBezierCurve3,y),w=new t.Geometry,E=(g+.1)*e.haloDensity;E<30&&(E=30),w.vertices=b.getPoints(E).reverse(),w.vertices.forEach(function(){w.colors.push(new t.Color(16777215))});var x=new t.LineBasicMaterial({color:e.color,opacity:1,blending:t.AdditiveBlending,transparent:!0,depthWrite:!1,vertexColors:!0,linewidth:1});return i=h(this,s(n).call(this,w,x)),Object.assign(i.userData,e),e.hasHalo&&i.initHalo(w),i.index=n.count++,n.array.push(l(l(i))),i}return r(n,t.Line),a(n,null,[{key:"draw",value:function(e){e.clearRect(0,0,128,128),e.fillStyle="#ffffff",e.arc(64,64,20,0,2*Math.PI,!1),e.fill(),e.fillStyle="rgba(255,255,255,.7)",e.arc(64,64,60,0,2*Math.PI,!1),e.fill()}},{key:"texture",get:function(){if(!n._texture){var e=document.createElement("canvas");e.width=128,e.height=128;var o=e.getContext("2d");n.draw(o);var i=new t.Texture(e);i.needsUpdate=!0,n._texture=i}return n._texture}}]),a(n,[{key:"initHalo",value:function(e){for(var o=this,i=e.vertices.length,a=new Float32Array(3*i),r=new Float32Array(3*i),s=new Float32Array(i),u=new t.Vector3,c=new t.Color(y(this.userData.color)),l=0;l<i;l++)u.x=e.vertices[l].x,u.y=e.vertices[l].y,u.z=e.vertices[l].z,u.toArray(a,3*l),c.toArray(r,3*l),s[l]=o.userData.haloSize;var h=new t.BufferGeometry;h.addAttribute("position",new t.BufferAttribute(a,3)),h.addAttribute("customColor",new t.BufferAttribute(r,3)),h.addAttribute("size",new t.BufferAttribute(s,1));var d=t.ShaderLib.line;d.uniforms={amplitude:{value:1},color:{value:new t.Color(y(this.userData.haloColor))},texture:{value:n.texture}};var m=new t.ShaderMaterial({uniforms:d.uniforms,vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,blending:t.AdditiveBlending,depthTest:!0,depthWrite:!1,transparent:!0}),p=new t.Points(h,m);p.dynamic=!0,this.add(p),this.halo=p,p.update=function(){if(o.userData.hasHalo&&o.userData.hasHaloAnimate){for(var e=.005*Date.now()+3*o.index,t=this.geometry.attributes,n=0;n<t.size.array.length;n++)t.size.array[n]=o.userData.haloSize+o.userData.haloSize*Math.sin(o.userData.haloRunRate*n+e);t.size.needsUpdate=!0}}}},{key:"update",value:function(){this.halo.update()}},{key:"setColor",value:function(e,n){void 0!==e&&(this.material.color=new t.Color(y(e)))}},{key:"setLineWidth",value:function(e){this.userData.hasHalo||console.warn("Setting the LineWidth must be hasHalo:true"),this.userData.haloSize=e}},{key:"onmouseout",value:function(e,t){if(this.userData.hoverExclusive&&n.array.map(function(e){e.halo&&(e.halo.visible=!0),e.setColor(e.userData.color)}),this.userData.hasHalo){var o=this.userData.haloSize/1.5;this.userData.haloSize=o}this.setColor(this.userData.color),e.dispatchEvent({type:"mouseout",target:this,orgEvent:t})}},{key:"onmouseover",value:function(e,t){var o=this;if(this.userData.hoverExclusive&&n.array.map(function(e){e.halo&&(e.halo.visible=!1),e.setColor(o.userData.decayColor)}),this.userData.hasHalo){var i=1.5*this.userData.haloSize;this.userData.haloSize=i,this.halo.visible=!0}this.setColor(this.userData.hoverColor?this.userData.hoverColor:this.userData.color),e.dispatchEvent({type:"mouseover",target:this,orgEvent:t})}},{key:"onmousedown",value:function(e,t){e.dispatchEvent({type:"mousedown",target:this,orgEvent:t})}}]),n}();L.count=0,L.array=[],L._texture=null;var z={amount:1,bevelThickness:1,bevelSize:.2,bevelEnabled:!1,bevelSegments:5,curveSegments:1,steps:1},H=function(){function e(t){if(o(this,e),m.webgl){var n={name:"",el:document.body,geoData:null,hasStats:!0,hasControls:!0,autoRotate:!1,ambientColor:3355443,directionalColor:16777215,hasLoadEffect:!1,debugger:!1,cameraPosition:{x:0,y:0,z:40},extrude:z,area:{data:[],name:"",color:3368703,hoverColor:16750899,lineColor:16777215,opacity:1,hasPhong:!0,shininess:50,hoverAnimaTime:300,loadEffect:!1,hasHoverHeight:!0},dataRange:{data:[],width:1,height:.7,position:{x:23,y:-8,z:1},spacing:.2,text:["高","低"],textColor:"#ffffff",showName:!1,namePosition:{x:-2,y:0,z:0},hoverColor:16750899,hoverAnimaTime:100,hasHoverHeight:!0,hasEvent:!0},mark:{data:[],name:"",color:16777215,hoverColor:16750899,hoverAnimaTime:100,min:.01,max:5},line:{data:[],color:5631743,hoverColor:16750899,hoverExclusive:!0,hoverAnimaTime:100,spaceHeight:5,hasHalo:!0,hasHaloAnimate:!0,haloDensity:2,haloRunRate:.01,haloColor:16777215,haloSize:10,decayColor:2236962},mapObject:null,areaGroup:null,lineGroup:null,markGroup:null,scene:null,camera:null,renderer:null,stats:null,controls:null,areaCount:0,_w:0,_h:0,__event:null};j(!0,n,t),j(!0,this,n),this.geoData?(this._w=this.el.offsetWidth,this._h=this.el.offsetHeight,console.time("init"),this.init(),console.timeEnd("init"),this.initEvent()):console.warn("Map3D no geoData.")}else console.warn("不支持webgl,停止渲染.")}return a(e,[{key:"init",value:function(){this.el.innerHTML="",this.scene=new t.Scene({antialias:!0}),this.camera=new t.PerspectiveCamera(70,this._w/this._h,.1,1e3),this.renderer=new t.WebGLRenderer({alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.camera.position.set(this.cameraPosition.x,this.cameraPosition.y,this.cameraPosition.z),this.camera.lookAt(this.scene.position),this.renderer.setSize(this._w,this._h),this.scene.fog=new t.Fog(16777215,.15,1e3),this.scene.add(new t.AmbientLight(y(this.ambientColor))),this.dirLight=new t.DirectionalLight(y(this.directionalColor)),this.dirLight.position.set(0,50,50),this.scene.add(this.dirLight),this.dirLightDown=new t.DirectionalLight(y(this.directionalColor)),this.dirLightDown.position.set(0,-50,0),this.scene.add(this.dirLightDown),this.spotLight=new t.SpotLight(y(this.color)),this.spotLight.position.set(0,150,150),this.spotLight.intensity=.7,this.spotLight.target=this.scene,this.scene.add(this.spotLight),this.mapObject=new t.Group,this.initControls(),this.initDebug(),console.time("initArea"),this.initArea(),console.timeEnd("initArea"),console.time("initMark"),this.initMark(),console.timeEnd("initMark"),console.time("initLine"),this.initLine(),console.timeEnd("initLine"),console.time("inintDataRange"),this.inintDataRange(),console.timeEnd("inintDataRange"),this.geoData.cp&&this.mapObject.position.set(-this.geoData.cp[0],-this.geoData.cp[1],0),this.scene.add(this.mapObject),this.scene.add(this.camera),this.el.appendChild(this.renderer.domElement),this.renderScene()}},{key:"initArea",value:function(e){var n,o=this;(Object.assign(this.area,e),T.count=0,this.areaGroup)&&(n=this.areaGroup).remove.apply(n,d(this.areaGroup.children));this.areaGroup=new t.Group,this.geoData.features.forEach(function(e){var t=o.area.data.find(function(t){return t.name===e.properties.name});Object.assign(e.properties,t),o.createArea(e)}),this.mapObject.add(this.areaGroup)}},{key:"inintDataRange",value:function(e){var n=this;Object.assign(this.dataRange,e);var o,i=Object.assign({extrudeHeight:this.extrude.amount/2},this.dataRange);(delete i.data,this.dataRangeGroup)&&(o=this.dataRangeGroup).remove.apply(o,d(this.dataRangeGroup.children));if(R.count=0,this.dataRangeGroup=new t.Group,this.dataRange.data.forEach(function(e){var t=Object.assign({},i,e),o=new R(t);o.rangeAreas=[],n.dataRangeGroup.add(o);var a=void 0===e.min?-999999999999:e.min,r=void 0===e.max?999999999999:e.max,s=null;n.area.data.forEach(function(t){void 0!==t.value&&a<t.value&&t.value<r&&(s=n.getArea(t.name))&&(o.rangeAreas.push(s),s.setColor(e.color))})}),this.dataRange.data.length>0){if(this.dataRange.text[0]){var a=C.create(this.dataRange.text[0],{color:this.dataRange.textColor});a.position.add({x:0,y:1,z:0}),this.dataRangeGroup.add(a)}if(this.dataRange.text[1]){var r=C.create(this.dataRange.text[1],{color:this.dataRange.textColor});r.position.add({x:0,y:-(this.dataRange.height+R.count*(this.dataRange.height+this.dataRange.spacing)),z:0}),this.dataRangeGroup.add(r)}}this.dataRangeGroup.position.add(this.dataRange.position),this.scene.add(this.dataRangeGroup)}},{key:"initMark",value:function(e){var n=this;Object.assign(this.mark,e);var o,i=Object.assign({extrudeHeight:this.extrude.amount},this.mark);(delete i.data,A.count=0,this.markGroup)&&(o=this.markGroup).remove.apply(o,d(this.markGroup.children));this.markGroup=new t.Group,this.mark.data.forEach(function(e){var t=Object.assign({},i,e),o=new A(t);n.markGroup.add(o)}),this.mapObject.add(this.markGroup)}},{key:"initLine",value:function(e){var n=this;Object.assign(this.line,e);var o,i=Object.assign({extrudeHeight:this.extrude.amount},this.line);(delete i.data,L.count=0,this.lineGroup)&&(o=this.lineGroup).remove.apply(o,d(this.lineGroup.children));this.lineGroup=new t.Group,this.line.data.forEach(function(e){var t=Object.assign({},i,e),o=new L(t);n.lineGroup.add(o)}),this.mapObject.add(this.lineGroup)}},{key:"addCameraPosition",value:function(e,n,o,i){var a=new t.Vector3(e.x,e.y,e.z);if("number"==typeof n){var r=this.camera.position.clone().add(a);i||(i=function(){}),new g.Tween(this.camera.position).to(r,n).delay(o||0).start().onComplete(i)}else this.camera.position.add(e.x,e.y,e.z)}},{key:"setCameraPosition",value:function(e,t,n,o,i){t&&"number"==typeof t?b(this.camera.position,e,t,n,o,i):this.camera.position.set(e.x,e.y,e.z)}},{key:"dispose",value:function(){this.el.innerHTML="",this.__event.dispose()}},{key:"disable",value:function(e){(e=void 0===e||e)?(this.el.style.pointerEvents="none",this.__event.enable=!e):(this.el.style.pointerEvents="",this.__event.enable=!e)}},{key:"initEvent",value:function(){this.__event=new f(this)}},{key:"initControls",value:function(){if(this.hasControls)return this.controls=new p(this.camera,this.renderer.domElement),this.controls.userPan=!1,this.controls.autoRotate=this.autoRotate,this.controls.userPanSpeed=1,this.controls}},{key:"initStats",value:function(){return this.stats=new P,this.stats.setMode(0),this.stats.domElement.style.position="absolute",this.stats.domElement.style.top="70px",this.stats.domElement.style.right="0px",this.el.appendChild(this.stats.domElement),this.stats}},{key:"initDebug",value:function(){if(this.debugger){this.name&&(window[this.name]=this),this.initStats();var e=new t.DirectionalLightHelper(this.dirLight,5);this.scene.add(e);var n=new t.SpotLightHelper(this.spotLight);this.scene.add(n);var o=new t.GridHelper(300,40);this.scene.add(o);var i=new t.AxisHelper(50);this.scene.add(i),this.infoPlane=document.createElement("div"),this.infoPlane.contentEditable=!0,this.infoPlane.style.position="absolute",this.infoPlane.style.bottom="70px",this.infoPlane.style.right="10px",this.infoPlane.style.padding="5px 10px",this.infoPlane.style.background="rbga(0,0,0,.5)",this.infoPlane.style.border="1px solid #aaa",this.infoPlane.style.borderRadius="5px",this.infoPlane.style.color="#eee",this.el.appendChild(this.infoPlane)}}},{key:"printCameraPosition",value:function(){var e=this.camera.position;this.infoPlane.textContent="相机位置 {x:"+e.x.toFixed(4)+",y:"+e.y.toFixed(4)+",z:"+e.z.toFixed(4)+"}"}},{key:"reomveArea",value:function(e){"string"==typeof e&&(e=this.getArea(e)),this.areaGroup.remove(e)}},{key:"removeMark",value:function(e){"string"==typeof e&&(e=this.getMark(e)),this.markGroup.remove(e)}},{key:"getArea",value:function(e){return this.areaGroup.getObjectByName(e)}},{key:"getMark",value:function(e){return this.markGroup.getObjectByName(areaName)}},{key:"getObjectsByName",value:function(e){var t=[];return this.scene.traverse(function(n){n.name===e&&t.push(n)}),t}},{key:"renderScene",value:function(){this.renderer.clear(),requestAnimationFrame(this.renderScene.bind(this)),this.areaGroup.children.map(function(e){e&&e.update()}),this.lineGroup.children.map(function(e){e.halo&&e.halo.update()}),this.markGroup.children.map(function(e){e.update()}),g.update(),this.hasControls&&this.controls.update(),this.debugger&&(this.stats.update(),this.printCameraPosition()),this.renderer.render(this.scene,this.camera)}},{key:"_onResize",value:function(){this.dispatchEvent({type:"resize",el:null})}},{key:"_onMouseMove",value:function(e,t){if(t.length>0){var n=this.selectedObj?this.selectedObj.id:"";this.selectedObj=null;for(var o=0;o<t.length;o++){if(t[o].object&&"Mesh"===t[o].object.type&&t[o].object.parent.type&&"Area"===t[o].object.parent.type){this.selectedObj=t[o].object.parent;break}if(t[o].object&&"Mark"===t[o].object.type){this.selectedObj=t[o].object;break}if(t[o].object&&t[o].object.parent==this.lineGroup&&"Line"===t[o].object.type){this.selectedObj=t[o].object;break}if(t[o].object&&t[o].object.parent&&"DataRange"===t[o].object.parent.type){this.selectedObj=t[o].object.parent;break}}if(this.selectedObj){if(n!=this.selectedObj.id){if(n){var i=this.scene.getObjectById(n);i&&i.onmouseout(this,e)}this.selectedObj.onmouseover(this,e)}}else if(n){var a=this.scene.getObjectById(n);a&&a.onmouseout(this,e)}}else this.selectedObj&&this.selectedObj.onmouseout(this,e),this.selectedObj=null}},{key:"_onMouseDown",value:function(e,t){if(t.length>0){for(var n=null,o=0;o<t.length;o++){if(t[o].object&&"Mesh"==t[o].object.type&&t[o].object.parent.type&&"Area"==t[o].object.parent.type){n=t[o].object.parent;break}if(t[o].object&&"Mark"===t[o].object.type){n=t[o].object;break}if(t[o].object&&t[o].object.parent&&"DataRange"===t[o].object.parent.type){n=t[o].object.parent;break}}n&&(this.debugger&&console.log(n),n.onmousedown(this,e))}}},{key:"createArea",value:function(e){var t=Object.assign({color:this.area.color,hoverColor:this.area.hoverColor,lineColor:this.area.lineColor,opacity:this.area.opacity,hasPhong:this.area.hasPhong,shininess:this.area.shininess,hoverAnimaTime:this.area.hoverAnimaTime,extrude:this.extrude,loadEffect:this.area.loadEffect,hasHoverHeight:this.area.hasHoverHeight},e.properties),n=[];if(e.geometry){if("Polygon"==e.geometry.type)n.push(e.geometry.coordinates[0]);else if("MultiPolygon"==e.geometry.type)for(var o=0;o<e.geometry.coordinates.length;o++)n.push(e.geometry.coordinates[o][0]);t.coords=n;var i=new T(t);this.areaGroup.add(i)}}}]),e}();Object.assign(t.EventDispatcher.prototype,{dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){var n=e.target;for(var o in e.orgEvent)e[o]=e.orgEvent[o];e.target=n||this;for(var i=t.slice(0),a=0,r=i.length;a<r;a++)i[a].call(this,e)}}}}),Object.assign(H.prototype,t.EventDispatcher.prototype);var G={Map3D:H};e.default=G,Object.defineProperty(e,"__esModule",{value:!0})});
